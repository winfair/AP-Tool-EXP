<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no" />
  <title>Geo Arrow — Stable Target Pointer (WGS‑84, Sensor‑Smoothed)</title>
  <style>
    :root{--bg:#0b0f12;--ink:#e8f1f0;--line:rgba(255,255,255,.16);--muted:#9fc0b8;--brand:#22d7b7;--accent:#ff4d4d}
    html,body{height:100%;margin:0;background:radial-gradient(120% 140% at 50% 20%,#131a20 0%,#0b0f12 60%,#06080a 100%);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif}
    #canvas{position:fixed;inset:0;display:block;width:100%;height:100%}
    .panel{position:fixed;left:12px;top:12px;z-index:10;background:rgba(10,14,18,.76);border:1px solid var(--line);backdrop-filter:blur(6px);padding:.8rem;border-radius:14px;display:flex;flex-direction:column;gap:.55rem;max-width:min(92vw,520px)}
    .row{display:flex;gap:.5rem;flex-wrap:wrap}
    .row>label{display:flex;flex:1 1 42%;align-items:center;gap:.35rem;background:rgba(255,255,255,.05);border:1px solid var(--line);padding:.35rem .5rem;border-radius:10px}
    input[type="number"], input[type="text"]{width:100%;background:transparent;border:none;outline:none;color:var(--ink);font-variant-numeric:tabular-nums}
    input[type="range"]{width:100%}
    .btn{appearance:none;border:1px solid var(--line);background:rgba(255,255,255,.06);color:var(--ink);padding:.52rem .8rem;border-radius:12px;font-weight:600;cursor:pointer}
    .btn:active{transform:translateY(1px)}
    .tiny{font-size:.85rem;color:var(--muted)}
    #perm{position:fixed;right:12px;bottom:12px;z-index:10}
    #readout{position:fixed;left:12px;bottom:12px;opacity:.95;font-variant-numeric:tabular-nums;background:rgba(0,0,0,.32);padding:.42rem .65rem;border-radius:10px;border:1px solid var(--line)}
  </style>
</head>
<body>
<canvas id="canvas"></canvas>
<div class="panel">
  <div class="tiny">Arrow points from <b>you → target</b> in true 3D (WGS‑84). Camera follows your device orientation. Added smoothing & deadband to reduce jitter.</div>
  <div class="row">
    <label title="Degrees">Lat° <input id="tLat" type="number" step="0.000001" placeholder="e.g. 48.137" /></label>
    <label title="Degrees">Lon° <input id="tLon" type="number" step="0.000001" placeholder="e.g. 11.575" /></label>
  </div>
  <div class="row">
    <label title="Meters">Alt (m) <input id="tAlt" type="number" step="0.1" placeholder="0" /></label>
    <button id="setTarget" class="btn" title="Apply target">Set Target</button>
  </div>
  <div class="row">
    <button id="useGps" class="btn" title="Use device GPS for your position">Use My Location</button>
    <button id="calYaw" class="btn" title="Zero yaw to current heading (visual align)">Calibrate</button>
    <button id="perm" class="btn" title="Enable motion/compass (iOS needs a tap)">Enable Sensors</button>
  </div>
  <div class="row">
    <label title="Lower = snappier, Higher = smoother">Stability <input id="stab" type="range" min="0" max="0.9" step="0.01" value="0.18" /></label>
    <label title="Ignore tiny heading changes">Deadband° <input id="dead" type="number" step="0.1" value="0.5" /></label>
  </div>
  <div class="tiny" id="status">Status: awaiting target & location…</div>
</div>
<div id="readout">az: —°  el: —° | me: —, —, —m</div>

<!-- ✅ Minimal JavaScript injected inline -->
<script src="https://cdn.jsdelivr.net/npm/three@0.160.1/build/three.min.js" crossorigin="anonymous"></script>
<script>
  // Minimal JavaScript from earlier will be pasted here ↓↓↓
</script>
</body>
</html>
