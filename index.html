<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Basic Sensor Test</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
</head>
<body>
  <h1>Basic Sensor Test</h1>

  <button id="startBtn">Start sensors (GPS + orientation)</button>

  <h2>GPS</h2>
  <div>Status: <span id="gpsStatus">idle</span></div>
  <div>Lat: <span id="gpsLat">—</span></div>
  <div>Lon: <span id="gpsLon">—</span></div>
  <div>Error: <span id="gpsError">—</span></div>

  <h2>Orientation</h2>
  <div>Status: <span id="oriStatus">idle</span></div>
  <div>Heading: <span id="heading">—</span></div>
  <div>Pitch: <span id="pitch">—</span></div>
  <div>Error: <span id="oriError">—</span></div>

  <script src="sensors.js"></script>
  <script>
    (function () {
      var btn       = document.getElementById('startBtn');
      var gpsStatus = document.getElementById('gpsStatus');
      var gpsLat    = document.getElementById('gpsLat');
      var gpsLon    = document.getElementById('gpsLon');
      var gpsError  = document.getElementById('gpsError');

      var oriStatus = document.getElementById('oriStatus');
      var heading   = document.getElementById('heading');
      var pitch     = document.getElementById('pitch');
      var oriError  = document.getElementById('oriError');

      function render(state) {
        if (!state) return;

        gpsStatus.textContent = state.gpsStatus;
        gpsLat.textContent =
          typeof state.gpsLat === 'number' ? state.gpsLat.toFixed(6) : '—';
        gpsLon.textContent =
          typeof state.gpsLon === 'number' ? state.gpsLon.toFixed(6) : '—';
        gpsError.textContent = state.gpsError || '—';

        oriStatus.textContent = state.oriStatus;
        heading.textContent =
          typeof state.headingDeg === 'number' ? state.headingDeg.toFixed(1) : '—';
        pitch.textContent =
          typeof state.pitchDeg === 'number' ? state.pitchDeg.toFixed(1) : '—';
        oriError.textContent = state.oriError || '—';
      }

      if (window.Sensors) {
        window.Sensors.onUpdate(render);

        btn.addEventListener('click', function () {
          window.Sensors.start();
        });
      } else {
        gpsStatus.textContent = 'Sensors.js not loaded';
      }
    })();
  </script>
</body>
</html>
